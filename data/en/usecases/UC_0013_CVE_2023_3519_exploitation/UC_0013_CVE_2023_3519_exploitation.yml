title: 'Exploitation CVE-2023-3519'
id: UC0013
author: '@ERMACK_COMMUNITY'
creation_date: 2023/08/19
modification_date: 2023/08/19
severity: M
tags:
  - attack.initial_access
  - attack.t1190
  - citrix
linked_response_playbooks:
linked_artifacts:
  - A2001
  - A2002
  - A1008
  - A2003
targets:
  - ID: S3006
    cpe_from: 'cpe:2.3:a:citrix:netscaler_application_delivery_controller:11.1-65.22:*:*:*:fips:*:*:*'
    cpe_to: 'cpe:2.3:a:citrix:netscaler_application_delivery_controller:11.1-65.22:*:*:*:fips:*:*:*'
  - ID: S3006
    cpe_from: 'cpe:2.3:a:citrix:netscaler_application_delivery_controller:12.1:*:*:*:fips:*:*:*'
    cpe_to: 'cpe:2.3:a:citrix:netscaler_application_delivery_controller:12.1-55.297:*:*:*:fips:*:*:*'
  - ID: S3006
    cpe_from: 'cpe:2.3:a:citrix:netscaler_application_delivery_controller:12.1:*:*:*:ndcpp:*:*:*'
    cpe_to: 'cpe:2.3:a:citrix:netscaler_application_delivery_controller:12.1-55.297:*:*:*:ndcpp:*:*:*'
  - ID: S3006
    cpe_from: 'cpe:2.3:a:citrix:netscaler_application_delivery_controller:13.0:*:*:*:-:*:*:*'
    cpe_to: 'cpe:2.3:a:citrix:netscaler_application_delivery_controller:13.0-91.13:*:*:*:-:*:*:*'
  - ID: S3006
    cpe_from: 'cpe:2.3:a:citrix:netscaler_application_delivery_controller:13.1:*:*:*:fips:*:*:*'
    cpe_to: 'cpe:2.3:a:citrix:netscaler_application_delivery_controller:13.1-37.159:*:*:*:fips:*:*:*'
  - ID: S3006
    cpe_from: 'cpe:2.3:a:citrix:netscaler_application_delivery_controller:13.1:*:*:*:-:*:*:*'
    cpe_to: 'cpe:2.3:a:citrix:netscaler_application_delivery_controller:13.1-49.13:*:*:*:-:*:*:*'
  - ID: S3006
    cpe_from: 'cpe:2.3:a:citrix:netscaler_gateway:13.0:*:*:*:*:*:*:*'
    cpe_to: 'cpe:2.3:a:citrix:netscaler_gateway:13.0-91.13:*:*:*:*:*:*:*'
  - ID: S3006
    cpe_from: 'cpe:2.3:a:citrix:netscaler_gateway:13.1:*:*:*:*:*:*:*'
    cpe_to: 'cpe:2.3:a:citrix:netscaler_gateway:13.1-49.13:*:*:*:*:*:*:*'

description: Attackers can use a vulnerability in Citrix Application Delivery Controller (ADC) and NetScaler Gateway to execute code and gain access to the internal network
extended_description: |
  
  Attackers can use a vulnerability in Citrix Application Delivery Controller (ADC) and NetScaler Gateway to execute code and gain access to the internal network
  
  The vulnerability is located in the nsppe module and can be exploited by an HTTP GET request to the endpoint /gwtest/formssso?event=start&target=<shellcode>
  
  Most often, attackers create a web shell on the system for further execution
  
  The implementation of this vulnerability is on [Github](https://github.com/BishopFox/CVE-2023-3519) and also in the [metasploit framework](https://www.metasploit.com/) in the module *exploit/freebsd/http/citrix_formssso_target_rce*
  
  ## Attack mapping
  
  | ARTIFACT/RESOURCE | DESCRIPTION |
  | :----------------| :----------|
  | **Attack Prerequisites** |
  | <[Citrix ADC]>(A_2001) network available | Network availability of Citrix ADC |
  | **Attack Consequences** |
  | Remote code execution on <[Web server]>(A_2002) | Possibility of remote code execution on the Citrix server |
  | **Side Observables** |
  | <[Log]>(A_1008) | Log entry about a successful GET request to a vulnerable */gwtest/formssso?event=start&target=<shellcode>* endpoint |
  | <[Web shell]>(A_2003) | Web shell on the target system with which attackers execute commands |
  
  ## References
  1. <https://www.mandiant.com/resources/blog/citrix-zero-day-espionage>
  2. <https://support.citrix.com/article/CTX561482/citrix-adc-and-citrix-gateway-security-bulletin-for-cve20233519-cve20233466-cve20233467>
  3. <https://nvd.nist.gov/vuln/detail/CVE-2023-3519#range-9436793>
  4. <https://bishopfox.com/blog/analysis-exploitation-cve-2023-3519>
  
  
  
  
